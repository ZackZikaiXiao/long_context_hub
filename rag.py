import torch
import torch.nn.functional as F

from torch import Tensor
from transformers import AutoTokenizer, AutoModel


def last_token_pool(last_hidden_states: Tensor,
                 attention_mask: Tensor) -> Tensor:
    left_padding = (attention_mask[:, -1].sum() == attention_mask.shape[0])
    if left_padding:
        return last_hidden_states[:, -1]
    else:
        sequence_lengths = attention_mask.sum(dim=1) - 1
        batch_size = last_hidden_states.shape[0]
        return last_hidden_states[torch.arange(batch_size, device=last_hidden_states.device), sequence_lengths]


def get_detailed_instruct(task_description: str, query: str) -> str:
    return f'Instruct: {task_description}\nQuery: {query}'


# Each query must come with a one-sentence instruction that describes the task
# task = 'Given a web search query, retrieve relevant passages that answer the query'
task = 'Given a JSON object, retrieve relevant value according to the query'
queries = [
    get_detailed_instruct(task, '\nKey: \"82e82b44-16a4-44a9-ad49-750d64f0c268\"\nThe value associated with the specified key is: ')
]
# No need to add instruction for retrieval documents
data = {"id": 0, "ans_id": 0, "context": "JSON data:\n{\"82e82b44-16a4-44a9-ad49-750d64f0c268\": \"b5de2783-fac8-4daa-a607-efd2ca19af71\", \"234bb820-58ab-44f1-8a4a-c9dd7accf698\": \"14baea62-380e-4dbf-857f-c87886e995c1\", \"189dc806-d442-4094-8515-ce8153844399\": \"f09e16a4-d128-4904-8d2d-a240c76f69d8\", \"b1a957c1-6a04-4429-8ec5-c3579d521ad8\": \"c23ed9df-7b10-425b-9632-3c4f19f78c0b\", \"1540b91f-88c9-4328-a52b-ae6def770397\": \"ce9ef1da-8e2a-43f9-860e-5d21ca15d51b\", \"c0b8ddd6-1b74-4de5-bb6c-a997419e8a7c\": \"71a20254-1c82-4986-9a92-b5ec54586827\", \"9246983a-aa89-4ef5-ad25-45fab8c33f83\": \"ba82a1f0-eaee-40da-a042-9c9fadf2ab7d\", \"8d6ae217-e0fe-47ea-913d-f445e3d03413\": \"a256716d-2c42-49fb-918f-7449c4e9bf31\", \"fa6bae6a-3d96-4e6d-9fc4-84e2201d7b81\": \"27ba7106-bfda-4de5-8830-ba5f0a3423fb\", \"c4cf24b5-0e40-48e2-9f46-3f855da64da4\": \"cf58a98a-f467-45ac-bfac-86e265639799\", \"1506054c-2ea8-4bd0-98c5-6b98a3e81a4f\": \"aa821571-a8bf-4b60-86d9-8c02c172c45c\", \"fc73d935-0317-46c4-9af7-9b0833448631\": \"9c1537c3-a294-44f0-a13d-6b7d047c4e53\", \"9ea1cbc6-19af-4c48-ad2b-8ac94bab8bef\": \"ae79ad54-863e-4e68-958f-6775c018db6b\", \"5f429425-c284-439a-af99-de2444226ea7\": \"a6126e1e-d138-4358-9247-0e041530cc06\", \"e3f72189-c48f-4051-9f17-29bd1687edb0\": \"3ae50906-328d-4e10-a222-19ea376d4cab\", \"a32fcdd0-b2ab-4567-a7aa-45f8350e16dc\": \"25900043-5d64-4684-8ade-6f1dc7b1067e\", \"42600309-c412-4897-acf6-b3cf6360d0fc\": \"d22c8400-3499-4e06-825b-db7aad2d1604\", \"6012cfe2-118d-4e2b-b693-65d05b2324a1\": \"4572842a-f8e9-46de-bec2-07823cfb4663\", \"46b3c89d-a3f4-4feb-8fb8-0d3cbc1a69cf\": \"291d9139-9bf5-48a1-852f-51a58b299798\", \"b9d446a7-7972-4f7c-a541-b1445aab4eb3\": \"bc3ac8c6-11ec-4768-86e9-3ddf6914040f\", \"67581b4b-6cff-4468-8d3f-6757a67406fc\": \"48cba639-8da4-460d-a32b-34e1951e6037\", \"f074f88b-7234-4b9c-92b6-0ded110ea717\": \"7493a87a-4361-4201-8cc1-c01b1d9cdf14\", \"7b6683db-f29c-4986-bbce-c6130b74678f\": \"7aee3d16-8916-41bf-abbd-302530aa00ab\", \"5cb2503e-9881-44b0-a4f6-040f740a1850\": \"ef53ca38-396f-4f67-96ca-dbef3e99b573\", \"2790915f-f6d0-4732-90c2-c9d26d0cd9bd\": \"88273f0e-53d2-4959-a4e7-ce532136d1a3\", \"ef17cc05-2bf0-43b1-b745-8f10d06d6e64\": \"f09f5edb-8170-462f-869c-d70d8809bb7d\", \"a39fa1f7-e083-428a-ba88-141688c1d469\": \"6914b7db-8ec3-405d-9220-817ebee40af5\", \"b22580b9-f8c9-428e-b15d-5af03304d8a9\": \"f205e438-70a6-467c-b22d-7c68a0c6e08a\", \"e10def25-e0ee-4d7e-b700-e04a0dba0c98\": \"9f433fe7-8a67-4321-bca9-81eafc075b49\", \"716ec434-b372-4313-bb47-c94e8b69ea9b\": \"9ef0405b-28fd-4a07-ace9-af5208ed8d72\", \"38630ef7-647e-476c-a388-54e44cc3d857\": \"429c4117-8a3f-4c5d-a50c-d4d51779911e\", \"98f68323-0a42-4d75-9418-98b00cb75440\": \"bc32d1b2-5432-4ce9-81b7-2bc8013471ef\", \"90bb0267-b896-4df2-8070-0dbb1e98a8e5\": \"035334b6-a03d-463f-9890-5a0faf43f797\", \"79754990-33a3-45a9-aadd-cde9f6821f0f\": \"b95a309a-fc54-4a76-b914-cb68975d25b9\", \"d8b41e74-3a97-43ea-a9ce-8345e9682327\": \"94bc98ea-c111-4d49-8c26-706e514910e4\", \"645d5ea6-526f-43a7-aa5e-ad4d08e20fa3\": \"7c97019b-8c69-42e8-9f57-acf8440917ea\", \"a56f6fae-f294-4dd9-85cd-ac466b76d1e1\": \"9a745324-95ce-4e98-b0cf-4b4d8e38d74d\", \"ba39ed93-7bb9-4900-9663-f290622f579c\": \"71a567e7-c964-4266-bfc5-617282602cd1\", \"ba5e72ad-0e2b-4f6d-818f-fe2ee798bc9a\": \"86252a33-1570-4984-8336-5beb8ee698af\", \"8e4f8e77-485c-4f5f-aaa9-64e8cbf41112\": \"6678aae8-afe3-4ae5-80e4-622239db39fd\", \"974d6a39-f630-4ef1-87ed-cbe3783cfdf0\": \"974c07e7-ef7a-4e45-b498-e76aea90f8d9\", \"02d9aa78-bfd8-4eea-a636-913582688ecc\": \"cb734fde-e43c-451a-9c47-b02886ddeb07\", \"96477c7d-9042-493f-ad22-fe92786a01ad\": \"83f9ceff-c145-4c33-a24b-74be47b918a5\", \"d9af05d4-9548-484c-9872-acf87942356b\": \"48828982-f1e0-44e1-baaf-d706c5f6fada\", \"f44fa770-455e-4406-acb7-9a7a0c030ce1\": \"20f4aa7d-fc10-4d57-a819-39d25804c3d4\", \"b6bbe586-42ce-43d3-88fb-83d755636b2a\": \"dceb48cb-8c8a-4168-917e-b53a2318a380\", \"cf793c35-9e38-476c-b5cd-a200492a7e4b\": \"279c524c-809a-4910-a7c9-dd9587a3af34\", \"27b97f52-04b4-41a5-9613-fa18bed3f448\": \"e9667eab-84c9-4bd9-9586-0fa91fb1057a\", \"ae90cf69-fc99-4650-8d0a-b4f3ae849bcc\": \"abe93ff1-c8d5-46e9-932f-05684a0a783f\", \"2a897bb2-c067-4b7a-9dd4-518bcf165ef2\": \"f6ff1b08-e33c-4850-b40e-297155cee251\", \"764af8e6-a42f-41de-9f5c-ca5bc26d71cf\": \"c95b152c-f68f-4937-a25a-785e1d890c9f\", \"fd813033-78c4-4f62-a952-0274a1fb24d7\": \"f619421f-00e1-4ec3-8396-3613e33afaa5\", \"78d7e5ab-9c73-4a97-997c-fa9f4be0d26b\": \"dd3d22ce-b9bc-4b33-8491-f67f9ab89584\", \"c6086121-c1a7-443d-8d03-7997785992e0\": \"a38d5e63-5ab1-4ee5-9688-072e743d4fc1\", \"78978e8b-7417-4f64-ba90-7d055233b01c\": \"b4bd546a-363c-4e00-a975-e5c6fd5bb45e\", \"0a76fd31-988f-4133-932a-a4dc0faddca1\": \"002b441a-cc0c-4a8e-8b71-a8fc338c8b64\", \"0f65441d-3a74-440b-a5ce-d088d1c0eac0\": \"2939d200-28f4-4210-a11e-b0de3d0d069f\", \"7828ac9d-c29b-4942-9d0d-acf08b1e9a1d\": \"f9b58b1b-7b77-40b7-b7a6-2a7f2000a9af\", \"e0c27596-b0c9-44be-8236-3826292b3275\": \"ae116bcb-f3ab-4458-b78c-905883969da6\", \"14f81c61-5cc3-4af6-9ed7-2c8b05398b37\": \"08aed57d-1640-469b-82a5-b3da8a40b287\", \"eb1ec679-a8a7-4f88-b325-4a1ea894ae98\": \"43648598-d0d6-45fb-ac42-eb9944c27aca\", \"4f4247e0-ea39-4fe2-a669-d32a7eab1787\": \"0ac6576e-56c0-42cb-a404-d0372033ed81\", \"d4a2bbe8-768c-438b-9d4e-a1fb8c3de576\": \"671fc72b-4174-476e-8a80-1d2f9359b1f3\", \"cf3e1b99-9647-4ddc-9869-ac2b173ee319\": \"1f450489-882b-4a72-a885-b4f0cde3cc37\", \"53654f6f-9ffb-4a89-baf2-d36a0c9a279f\": \"90b63331-c1b5-4136-8a5c-e87eaa7f0899\", \"09339e5f-d6e5-4930-a47a-35c1ff7ff949\": \"1303758f-acee-4d07-941f-bf2774e2e211\", \"c7dc88e8-7751-4a28-8e5a-783d38a7e8c7\": \"77db6572-bf9c-44d5-9d16-1a991e75d32c\", \"10735fca-f839-44a3-ba06-696c33c0a29a\": \"b71bcac9-4306-42dc-9bf3-cf0fb14a75fc\", \"65f221bc-b6f1-4e1c-9518-c82070a7cc8a\": \"a4c2c6a9-d85c-4b70-a582-4b974c68b15c\", \"d480d033-3a67-4a10-8a75-601ea3c89c1b\": \"34b60fb8-5d90-4440-9d37-ff023540b446\", \"e3a9159f-b7a9-421c-bade-f2bc309f1e5c\": \"0cd967d9-1fac-4f8f-b969-c5f2464c09fa\", \"c6e36a4e-2a2e-471d-9174-952b534e015d\": \"5c5fee14-5908-4825-b511-63f81c830009\", \"b3b307b3-9897-4406-9274-05f9d4ca4884\": \"f88d06c1-947c-49ee-8d79-d3f0a5a29035\", \"2651698b-4571-4328-9430-7caa01541cd1\": \"d8018e6a-4ff4-420c-a0ec-5472cbf8d09b\", \"f44f7c08-7afb-47c8-a489-128c7356b180\": \"da8ef884-118e-4f38-ad18-b8d92b1161ef\", \"a5b65376-b583-4e41-a04e-a93aadf29585\": \"06392ef6-6238-4e93-8c3e-2d62cd146c54\", \"d50098c8-41f0-43f9-a8f2-15b8eec77810\": \"fcf46e17-c0f9-45d7-aef2-c25eabd3bff0\", \"9f555235-e3a0-4bfa-9ec5-b864da12a6c0\": \"42de5a97-c420-41e2-808c-ed089b00e365\", \"5831f689-5a18-474b-8349-153cce5e2bad\": \"78925ead-a82c-4927-ad93-d14b92b3affc\", \"b93bf0c5-3309-46ba-9212-b3ecf4fd2c3c\": \"8cf4d6e6-d10d-429b-aece-2a5d8e606169\", \"df00a274-0123-44c3-bcf9-3fbc5823b7bd\": \"76fe2bbb-5c66-4737-b65f-d83d732d770a\", \"1b902ca6-a68f-4a8b-9d13-9fc3341b8bd8\": \"90625c9c-f480-4e8f-98dc-9eab4b2f8261\", \"8e201bad-f86a-47fc-85f1-3a1cf6004782\": \"22f5919e-4a96-4f26-b9a5-f0d18737db4e\", \"24671b00-a0f5-4e9b-a93f-82397ece9feb\": \"a95cdea2-5411-4d7b-9973-815a78e6d904\", \"d6b5ccc2-43f5-4b96-9a61-9424e7ed411b\": \"bb20a6d9-6a24-45b5-8f5e-b2d4c9b33ee4\", \"caa65ec8-f069-4118-b282-dd5a0cbba52e\": \"b4d0a8db-1fa6-4c45-be6a-531491bf5c8a\", \"763855a7-0528-4baf-a149-8f8e50c09262\": \"8cef9495-1854-42a6-99f0-d4610bb19721\", \"f41dde75-2162-4358-a1eb-da4e8240f714\": \"20f0adbe-56bf-492d-82a4-e39aa3364dd0\", \"b2ead45a-a4f3-4760-83a6-9578143774f1\": \"ed424f26-fd39-46d7-a370-a2c8279b9140\", \"1bfcfe7c-1195-4ced-8ed5-c72f82ccbf52\": \"dd8bf0f8-1409-49c3-a43a-2d36cb635765\", \"f1d27a06-6361-49df-934d-dd73eff27a3a\": \"204419f4-0cbd-4504-ba16-697779bf428b\", \"53a5ea06-3588-4014-b608-769de79c8282\": \"4451ef8c-9a51-407d-a3a3-cc48e7874b5e\", \"b8218a41-a7d7-42f4-bf3e-dfca58a8fc4f\": \"8377447e-f7ad-49d7-bef7-e938b8d84dc7\", \"13906263-350b-4e55-9a6b-0840f53b969c\": \"22086a25-cc7d-4591-b75f-5755c48d82dc\", \"3b0ab912-bed3-4456-b717-f8710303bd8f\": \"a654d143-bf0a-43e4-a194-64a4ec211dd5\", \"e89bba0b-b7e4-4912-8715-565736b73d47\": \"5d24f674-aa6b-4998-b0c7-cb97145499d4\", \"14d3ebd2-8ed3-4679-a423-dbcb27441df4\": \"62fe79b6-5328-43f3-901d-7f90bff0ec47\", \"059a1a5e-278a-493d-acc2-7d585ba2f90e\": \"e462d385-8437-40aa-87f8-0387638aa127\", \"51dacb12-1bde-470e-848f-615e8c7a451f\": \"4993d2a4-32a4-49d8-a9e5-b642f9829db4\", \"e1b971f8-6bfe-4d16-b831-23cf3b111d25\": \"5ae7deec-c42a-4698-b975-de8dff387b7a\", \"1a031971-6fa2-4ebd-8d3b-17df7de9a65f\": \"c81d0b65-cb60-4783-b7c7-ed5618e0e979\", \"49f32095-9d06-41d2-84a5-e6ae8984709c\": \"44c3228a-7449-4f7d-bb3d-623b646bbe59\", \"68c69c36-f720-4cdc-aeac-0b9a47ee1bbc\": \"b3a6eb87-f03b-45a1-956a-b320866652d4\", \"f2d0b149-63a6-4a90-94cb-01429a6b911b\": \"9a91771f-dbe3-41b8-9660-1d563e64b7f2\", \"07488330-6df0-469b-a14d-377a240fa821\": \"4f1cdc16-aae9-47a7-93b4-43a6dc8b712d\", \"1c93695b-fe17-4e28-b791-6c627bf754a3\": \"ae0501cb-913e-41f1-bd78-72b50ff57c25\", \"13c70f7b-c91d-4240-b64b-acd971f938b4\": \"b62cdc4a-dbb4-4b6e-b50b-518ee63cee69\", \"9302464d-9505-4187-870b-ba0de04c20e2\": \"e36c9827-e35e-4dd4-adb6-20c15e34ade9\", \"f1c64e56-b55d-4c62-b921-55165a86d04a\": \"1b81e714-3afa-4de2-8c19-fe0498dce55a\", \"802fc15f-367b-4b63-b8ef-28480deda820\": \"51d89c1f-f2f6-4703-8377-de421978c1b6\", \"8ef0baa8-2110-4e79-9d15-d42c4fc76d81\": \"87597256-86f1-463b-b0cc-2a57acb85887\", \"3706d943-2155-4ecd-afb6-f95074d15725\": \"e231497b-5c9a-42c6-a5ef-72b1b9821500\", \"7d9d7e9f-e015-4382-b821-a4f403b93d17\": \"8bcb8da3-14a7-4f79-8c5e-410dfa14fc3e\", \"2225d8d2-56d0-48e4-8a63-82571d8a7558\": \"f7eb786d-40fd-49d2-825f-475060adb8cc\", \"74485643-40b1-4981-ab33-546dcff1182c\": \"a624a917-7b48-4895-9534-4a25baeb9c97\", \"d3a86b59-18e3-4733-a3cd-50e5c255f04e\": \"d95aa7e5-f7b4-4387-9804-d203ba77aeab\", \"5422fd11-64d4-443c-b05c-506ba8a847c0\": \"3f3d0f45-0a12-41b7-b31b-c4fb4563415d\", \"28ad8cf3-51a8-46b2-a63b-441617bea9af\": \"a603c80e-d2e3-4fcb-84e9-fbc84cbfe758\", \"2ec5a6bb-8526-46f1-91e8-623aaaafae09\": \"55a87be2-ca72-4890-b8ae-45a8cac213bb\", \"f7e6130e-88e9-4830-b978-0c959aac80c1\": \"8b27af56-9ff9-456a-add7-ebe91f1c64aa\", \"70ddba32-9bcf-4d95-8367-b04bfe9a0951\": \"899a7d1b-375c-4f88-b481-7ae734741b51\", \"1e5af17d-d434-47ff-91af-6559e5b9df8f\": \"1633b172-4c82-494c-9d07-f94aea0f75d1\", \"8c7feb6a-c6b9-4955-9da1-0595418971f4\": \"beba6260-a30b-43ea-afdd-7bc2310243ac\", \"b6f9795d-9760-4386-8895-75fb8521a492\": \"02375876-9c9b-444f-a83c-abfe3db666fa\", \"b538c5a0-ff42-4ab9-ac5b-164935df57e9\": \"00ea5c56-8234-494a-9889-fd8de873567f\", \"2e279b4e-61d3-4021-9043-cbafa4332253\": \"3a19aebf-e2bc-46dd-8b10-6e820a1524d1\", \"128828dd-fcc2-42d9-87cd-10bcbc391ffa\": \"fbeccc6e-06c6-42e0-a21a-6f6e19bdbc2b\", \"ae038317-1052-4ee5-8d0c-9941c2bc4dfe\": \"b409762d-ff5e-4c9a-925f-5cc1383d110e\", \"b477f4e3-641f-4b14-a029-c5ddb10d3574\": \"d2d99e7d-01b7-4dd6-a2dc-583032bf9c36\", \"444fb732-c5c4-48bf-b6fa-ea53755061aa\": \"bab1ffdb-ee5b-4c78-b04d-27f13a10d7a5\", \"b46e0233-6e5b-4c64-8bf8-a414c6713e77\": \"79cfb33c-c2df-4c1e-8b94-7ad489905a38\", \"f26c2925-8482-4e99-9802-6eba6e768f3a\": \"7d6efc06-75a6-4a9f-8601-5142247865d9\", \"26893f1e-b75f-496b-a2fe-22c058eca7bd\": \"71313bf3-7175-4dd8-9874-efbb0aa26d0e\", \"01b91264-e09d-40a6-9290-c9d79c448df7\": \"42949bae-a97b-48e8-82b6-ce4fe864cd1a\", \"cdfdb13e-eb4e-4214-8344-afc2fc2d1d13\": \"4c944ec8-706c-40dd-acde-81241247c838\", \"769dece0-eea0-40e0-8156-5f04b0b631e1\": \"1f4e2902-e8c4-408d-a7b0-894c9e2f191f\", \"a1105cba-7a92-4259-81ad-70155402f4d1\": \"d37fe7f7-8b67-4460-8b92-764bfad632e5\", \"56177d01-3eae-40d0-ae4c-cc186035485a\": \"f1b4323f-bbde-4627-9d6d-2cdc7d69fe4e\", \"e9828b77-3d50-4297-9799-196ee5ecb280\": \"96f93e94-63a7-4680-9d0a-28a90005db8e\", \"bd9e5548-4830-472c-a8aa-fa9371f8565d\": \"3d531611-9d7b-422a-9503-7260321ed2c3\", \"8912a059-5f25-4e1e-aef0-6752a50000ad\": \"101756fa-0b0b-4719-9a0e-87675cedb875\", \"73dea970-8ada-4ffa-9a6b-2b6c7d3898af\": \"41197113-ddf0-4b95-9de4-82156dbb1089\", \"75ae8a33-5ad7-411b-a261-660b3ea52142\": \"bd4c96b0-4b3b-467a-92b0-f8fbe6a7b2ee\", \"810a1db5-8b5d-416e-b2cb-d229f9bb94d1\": \"c8fff549-a53b-4b0c-b4ef-3bb889315526\", \"ec167c4a-e346-42bb-bbeb-0900a55ac3e3\": \"4e935c07-2b72-433e-8697-7d9396b08c36\", \"1c56a95d-dd7c-4d6e-9119-8e97370e1d00\": \"203efc10-0a32-4119-9a07-a9aa49227806\", \"2afaa8ea-2d81-4bb9-be9f-82362ba1b107\": \"bf9685d9-fabb-48c7-a9b0-0e518d2eec05\", \"1c79136d-030b-4e5f-a87c-6e9796b582bb\": \"8cfcee58-c3fd-4ed9-b4a2-e41a9caa9e6f\", \"c5d276d1-1d42-46d0-a78e-1dc6a4273dbc\": \"cbb52ffe-2182-48a6-bcc7-601c7b4f1f6e\", \"34f8fa23-0ebe-4784-b3ae-27adb4fd1e13\": \"de369a06-839b-4be0-b460-77d44ee9fe8a\"}", "input": "\nKey: \"82e82b44-16a4-44a9-ad49-750d64f0c268\"\nThe value associated with the specified key is: ", "answer": "b5de2783-fac8-4daa-a607-efd2ca19af71"}
context_ = data["context"]
# 参数
length = 30
# 将字符串按指定长度分段
context_list = [context_[i:i+length] for i in range(0, len(context_), length)]
# 输出分段后的列表
print(context_list)

input_ = data["input"]


documents = [
    "As a general guideline, the CDC's average requirement of protein for women ages 19 to 70 is 46 grams per day. But, as you can see from this chart, you'll need to increase that if you're expecting or training for a marathon. Check out the chart below to see how much protein you should be eating each day.",
    "Definition of summit for English Language Learners. : 1  the highest point of a mountain : the top of a mountain. : 2  the highest level. : 3  a meeting or series of meetings between the leaders of two or more governments."
]
input_texts = queries + context_list

tokenizer = AutoTokenizer.from_pretrained('./models/e5-mistral-7b-instruct')
model = AutoModel.from_pretrained('./models/e5-mistral-7b-instruct')

max_length = 128
# Tokenize the input texts
batch_dict = tokenizer(input_texts, max_length=max_length, padding=True, truncation=True, return_tensors='pt')

outputs = model(**batch_dict)
embeddings = last_token_pool(outputs.last_hidden_state, batch_dict['attention_mask'])

# normalize embeddings
embeddings = F.normalize(embeddings, p=2, dim=1)
scores = (embeddings[:1] @ embeddings[1:].T) * 100
# print(scores.tolist())
# 获取top3高分及其对应的索引
top3_scores, top3_indices = torch.topk(scores, 10, dim=1)

# 转换为列表
top3_scores = top3_scores.tolist()[0]
top3_indices = top3_indices.tolist()[0]

# 输出top3的分数和对应的数据
for idx, score in zip(top3_indices, top3_scores):
    print(f"Index: {idx}, Score: {score}, Data: {context_list[idx]}")